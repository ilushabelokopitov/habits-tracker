# Лабораторная работа №5 — Моделирование поведения (Use Case + Sequence)

## Вариант
**Трекер привычек**: ежедневное отслеживание полезных привычек (спорт, вода, чтение) с отображением прогресса (график/статистика) и поддержкой напоминаний.

---

## 1. Назначение системы
Приложение предназначено для создания и ведения списка привычек, регулярной отметки их выполнения и анализа прогресса за выбранный период. Пользователь может задавать цель и расписание уточняющее, когда привычку нужно выполнять, а также просматривать статистику: процент выполнения, текущую/максимальную серию (streak) и график выполнения по дням.

---

## 2. Акторы

### 2.1 Пользователь
Основной актор, выполняющий действия в системе:
- создаёт, редактирует и удаляет привычки;
- отмечает выполнение привычки за день;
- просматривает прогресс и статистику;
- настраивает напоминания (если функция включена).

### 2.2 Сервис уведомлений (внешний актор)
Внешняя система/служба (ОС или сторонний сервис), отвечающая за доставку уведомлений. Используется для:
- создания/планирования уведомлений по расписанию;
- отправки пользователю напоминания в заданное время.

---

## 3. Основные сущности предметной области
- **Habit (Привычка)** — название, описание (опционально), тип/категория, цель, расписание, признак активности.
- **CompletionLog (Запись выполнения)** — привычка, дата, отметка выполнения (и/или значение, если привычка количественная).
- **Reminder (Напоминание)** — время, дни недели/частота, включено/выключено.
- **Progress/Statistics (Прогресс/Статистика)** — рассчитанные показатели (процент выполнения, серии, данные для графика).

---

## 4. Use Case (краткий перечень)
- **UC1 Создать привычку**
- **UC2 Редактировать привычку**
- **UC3 Удалить привычку**
- **UC4 Отметить выполнение привычки за день**
- **UC5 Просмотреть прогресс (график/стрик/статистика)**
- **UC6 Фильтровать/сортировать привычки**
- **UC7 Настроить напоминания**
- **UC8 Получить напоминание**

---

## 5. Общие бизнес-правила и проверки
1. У привычки должно быть задано **название** (не пустое).
2. Цель и расписание должны быть **валидны** (например, цель > 0, выбран хотя бы один день или указана периодичность).
3. Нельзя отметить выполнение для несуществующей привычки.
4. При отметке выполнения за дату, если запись уже есть — возможны варианты:
   - обновить запись (перезаписать);
   - либо запретить повторную отметку (зависит от реализации).
5. Прогресс рассчитывается на основании:
   - списка привычек,
   - их расписания,
   - и журнала выполнений за выбранный период.

---

## 6. Диаграммы последовательности

Все диаграммы находятся в папке:
`docs/behavior/sequence/`

Ниже описание того, что показывает каждая диаграмма.

### 6.1 UC1 — Создание привычки
**Файл:** `create_habit_sequence.puml` (+ экспорт `.png/.svg`)

**Цель:** добавить новую привычку в систему.

**Основной поток:**
1. Пользователь нажимает «Добавить привычку».
2. UI показывает форму (название, цель, расписание, напоминания).
3. Пользователь вводит данные и нажимает «Сохранить».
4. Контроллер выполняет валидацию данных.
5. При успехе создаётся объект Habit и сохраняется в репозиторий/БД.
6. UI обновляет список привычек и показывает результат.

**Альтернативы:**
- Если данные невалидны (пустое имя, некорректная цель/расписание) — UI показывает сообщение об ошибке.

---

### 6.2 UC4 — Отметить выполнение привычки за день
**Файл:** `mark_done_sequence.puml` (+ экспорт `.png/.svg`)

**Цель:** зафиксировать факт выполнения привычки за выбранную дату.

**Основной поток:**
1. Пользователь на экране привычки нажимает «Отметить выполнение».
2. UI отправляет запрос контроллеру `markAsDone(habitId, date)`.
3. Контроллер получает привычку из хранилища по `habitId`.
4. В объекте Habit фиксируется выполнение на указанную дату.
5. Состояние сохраняется в хранилище/репозиторий.
6. UI обновляет экран и показывает успешное сохранение.

**Альтернативы:**
- Привычка не найдена — UI показывает ошибку «Не найдено».
- Ошибка сохранения — UI показывает ошибку сохранения (например, проблемы с БД).

---

### 6.3 UC5 — Просмотреть прогресс (график/статистика)
**Файл:** `view_progress_sequence.puml` (+ экспорт `.png/.svg`)

**Цель:** показать пользователю прогресс выполнения привычек за период.

**Основной поток:**
1. Пользователь открывает раздел «Прогресс» и выбирает фильтр (период, одна привычка или все).
2. UI запрашивает у контроллера данные `getProgress(filter)`.
3. Контроллер получает список привычек (по фильтру).
4. Контроллер получает журнал выполнений за период.
5. Сервис расчёта прогресса формирует статистику:
   - процент выполнения,
   - текущий/максимальный streak,
   - данные для графика по дням.
6. UI отображает график и рассчитанные показатели.

**Альтернативы:**
- Нет данных за период — UI отображает нулевую статистику/пустой график с пояснением.

---

### 6.4 UC7 — Настроить напоминания (опционально)
**Файл:** `set_reminder_sequence.puml` (+ экспорт `.png/.svg`)

**Цель:** включить напоминания для привычки и запланировать уведомления.

**Основной поток:**
1. Пользователь открывает настройки привычки.
2. Указывает время/дни и включает напоминания.
3. Контроллер сохраняет настройки напоминаний в БД.
4. Система обращается к NotificationService.
5. NotificationService регистрирует уведомления во внешнем сервисе уведомлений.
6. UI сообщает пользователю об успешном сохранении.

**Альтернативы:**
- Привычка не найдена — ошибка «Не найдено».
- Ошибка внешнего сервиса — показать ошибку и предложить повторить.

---

## 7. Примечание по структуре хранения артефактов
- Use Case диаграмма размещается в `docs/use_case/`
- Диаграммы последовательности размещаются в `docs/behavior/sequence/`
- Исходники PlantUML хранятся в `.puml`, экспортированные изображения — в `.png` или `.svg`.

